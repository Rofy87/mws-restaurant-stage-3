{"version":3,"sources":["restaurant_bundle.js"],"names":["r","e","n","t","o","i","f","c","require","u","a","Error","code","p","exports","call","length","1","module","Object","defineProperty","value","obj","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","key","Constructor","protoProps","staticProps","prototype","_idb","_idb2","__esModule","default","DBHelper","instance","TypeError","_classCallCheck","this","open","upgradeDB","oldVersion","createObjectStore","keyPath","createIndex","DBOpen","then","db","transaction","objectStore","getAll","items","forEach","item","put","complete","console","log","catch","ex","id","index","parseInt","data","fetch","REVIEW_DATABASE_URL","method","headers","Accept","Content-Type","body","JSON","stringify","response","json","reviews","push","addReviewsToCache","clear","clearOfflineReviews","getAllReviewsFromOfflineCache","sendReview","callback","getRestaurantsFromCache","restaurants","RESTAURANT_DATABASE_URL","addRestaurantsToCache","fetchRestaurants","error","restaurant","find","REVIEWS_DATABASE_URL","Promise","all","getReviewsFromCache","getReviewsFromOfflineCache","_ref","concat","apply","arr","Array","isArray","arr2","from","_toConsumableArray","cuisine","results","filter","cuisine_type","neighborhood","neighborhoods","map","v","uniqueNeighborhoods","indexOf","cuisines","uniqueCuisines","google","maps","Marker","position","latlng","title","name","url","urlForRestaurant","animation","Animation","DROP","idb","2","_dbhelper","_dbhelper2","navigator","serviceWorker","register","ready","registration","document","getElementById","addEventListener","preventDefault","submitReview","saveReview","addReviewsToOfflineCache","sync","window","initMap","fetchRestaurantFromURL","addEventListeners","mapContainer","lat","lng","style","backgroundImage","self","Map","zoom","center","scrollwheel","fillBreadcrumb","mapMarkerForRestaurant","fetchReviewFromURL","swap_map","display","getParameterByName","fetchRestaurantById","fillRestaurantHTML","fetchReviewById","fillReviewsHTML","arguments","undefined","innerHTML","address","image","className","alt","filename","imageUrlForRestaurant","src","setAttribute","operating_hours","fillRestaurantHoursHTML","operatingHours","hours","rowTH","createElement","dayTh","timeTH","appendChild","row","day","time","container","noReviews","ul","review","createReviewHTML","li","header","date","Date","createdAt","toLocaleDateString","year","month","hour","minute","rating","comments","breadcrumb","location","href","replace","RegExp","exec","decodeURIComponent","restaurant_id","_reviews","validation","reset","addReviewToDom","getTime","_ul","_li","./dbhelper","3","promisifyRequest","request","resolve","reject","onsuccess","result","onerror","promisifyRequestCall","args","proxyProperties","ProxyClass","targetProp","properties","prop","get","set","val","proxyRequestMethods","proxyMethods","proxyCursorRequestMethods","Cursor","Index","_index","cursor","_cursor","_request","ObjectStore","store","_store","Transaction","idbTransaction","_tx","oncomplete","onabort","UpgradeDB","_db","DB","IDBIndex","IDBCursor","methodName","IDBObjectStore","IDBTransaction","IDBDatabase","funcName","slice","nativeObject","query","count","iterateCursor","continue","exp","version","upgradeCallback","indexedDB","onupgradeneeded","event","delete"],"mappings":"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","file":"../restaurant_bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n/**\r\n * Common database helper functions.\r\n */\n\n\nvar _idb = require('idb');\n\nvar _idb2 = _interopRequireDefault(_idb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DBHelper = function () {\n  function DBHelper() {\n    _classCallCheck(this, DBHelper);\n  }\n\n  _createClass(DBHelper, null, [{\n    key: 'DBOpen',\n    value: function DBOpen() {\n      var dbPromise = _idb2.default.open('mws', 2, function (upgradeDB) {\n\n        switch (upgradeDB.oldVersion) {\n          case 0:\n            var restaurantsStore = upgradeDB.createObjectStore('restaurants', { keyPath: 'id' });\n          case 1:\n            var reviewsStore = upgradeDB.createObjectStore('reviews', { keyPath: 'id' });\n            reviewsStore.createIndex('restaurant', 'restaurant_id');\n            var offlineStore = upgradeDB.createObjectStore('offlineReviews', { keyPath: 'createdAt' });\n            offlineStore.createIndex('restaurant', 'restaurant_id');\n\n        }\n      });\n      return dbPromise;\n    }\n  }, {\n    key: 'getRestaurantsFromCache',\n    value: function getRestaurantsFromCache() {\n      return DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction('restaurants', 'readonly');\n        var objectStore = transaction.objectStore('restaurants');\n        return objectStore.getAll();\n      });\n    }\n  }, {\n    key: 'addRestaurantsToCache',\n    value: function addRestaurantsToCache(items) {\n      DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction(['restaurants'], 'readwrite');\n        var objectStore = transaction.objectStore('restaurants');\n        items.forEach(function (item) {\n          return objectStore.put(item);\n        });\n        return transaction.complete;\n      }).then(function () {\n        console.log(\"Restaurants were added to Cache\");\n      }).catch(function (ex) {\n        console.log(\"Failed to Add  Restaurant to Cache\");\n      });\n    }\n  }, {\n    key: 'getReviewsFromCache',\n    value: function getReviewsFromCache(id) {\n\n      return DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction('reviews', 'readonly');\n        var objectStore = transaction.objectStore('reviews');\n        var reviewIndex = objectStore.index('restaurant');\n        return reviewIndex.getAll(parseInt(id));\n      });\n    }\n  }, {\n    key: 'getReviewsFromOfflineCache',\n    value: function getReviewsFromOfflineCache(id) {\n      return DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction('offlineReviews', 'readonly');\n        var objectStore = transaction.objectStore('offlineReviews');\n        var reviewIndex = objectStore.index('restaurant');\n        return reviewIndex.getAll(parseInt(id));\n      });\n    }\n  }, {\n    key: 'getAllReviewsFromOfflineCache',\n    value: function getAllReviewsFromOfflineCache() {\n      return DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction('offlineReviews', 'readonly');\n        var objectStore = transaction.objectStore('offlineReviews');\n        return objectStore.getAll();\n      });\n    }\n  }, {\n    key: 'addReviewsToCache',\n    value: function addReviewsToCache(items) {\n      DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction(['reviews'], 'readwrite');\n        var objectStore = transaction.objectStore('reviews');\n        items.forEach(function (item) {\n          return objectStore.put(item);\n        });\n        return transaction.complete;\n      }).then(function () {\n        console.log(\"Reviews were added to Cache\");\n      }).catch(function (ex) {\n        console.log(\"Failed to Add Reviews to Cache\");\n      });\n    }\n  }, {\n    key: 'addReviewsToOfflineCache',\n    value: function addReviewsToOfflineCache(item) {\n      DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction(['offlineReviews'], 'readwrite');\n        var objectStore = transaction.objectStore('offlineReviews');\n        objectStore.put(item);\n        return transaction.complete;\n      }).then(function () {\n        console.log(\"added to Offline Cache\");\n      }).catch(function (ex) {\n        console.log(\"Failed to Add to Offline Cache\");\n      });\n    }\n\n    /**\r\n     * Save review .\r\n     */\n\n  }, {\n    key: 'saveReview',\n    value: function saveReview(data) {\n\n      return fetch(DBHelper.REVIEW_DATABASE_URL(), {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        var reviews = [];\n        reviews.push(json);\n        DBHelper.addReviewsToCache(reviews);\n        console.log(\"Reviews were added to database\");\n      });\n    }\n  }, {\n    key: 'clearOfflineReviews',\n    value: function clearOfflineReviews() {\n\n      DBHelper.DBOpen().then(function (db) {\n        var transaction = db.transaction(['offlineReviews'], 'readwrite');\n        var objectStore = transaction.objectStore('offlineReviews');\n        objectStore.clear();\n      }).then(function () {\n        console.log(\"Offline Reviews were deleted\");\n      }).catch(function (ex) {\n        console.log(\"Failed to delete offline Reviews\");\n      });\n    }\n  }, {\n    key: 'sendReview',\n    value: function sendReview(data) {\n\n      return fetch(DBHelper.REVIEW_DATABASE_URL(), {\n        method: 'POST',\n        headers: {\n          'Accept': 'application/json',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        //console.log(json)\n        DBHelper.clearOfflineReviews();\n        console.log(\"Reviews were added to database\");\n      }).catch(function (ex) {\n        console.log('Failed to add review to database');\n      });\n    }\n  }, {\n    key: 'sendOfflineReviewsToDatabse',\n    value: function sendOfflineReviewsToDatabse() {\n      return DBHelper.getAllReviewsFromOfflineCache().then(function (reviews) {\n        reviews.forEach(function (data) {\n          return DBHelper.sendReview(data);\n        });\n      }).catch(function (ex) {\n        console.log(\"Coudnt Open Offline Cache\");\n      });\n    }\n    /**\r\n     * Database URL.\r\n     * Change this to restaurants.json file location on your server.\r\n     */\n\n  }, {\n    key: 'RESTAURANT_DATABASE_URL',\n    value: function RESTAURANT_DATABASE_URL() {\n      var port = 1337; // Change this to your server port\n      return 'http://localhost:' + port + '/restaurants';\n    }\n  }, {\n    key: 'REVIEWS_DATABASE_URL',\n    value: function REVIEWS_DATABASE_URL(id) {\n      var port = 1337; // Change this to your server port\n      return 'http://localhost:' + port + '/reviews/?restaurant_id=' + id;\n    }\n  }, {\n    key: 'REVIEW_DATABASE_URL',\n    value: function REVIEW_DATABASE_URL() {\n      var port = 1337; // Change this to your server port\n      return 'http://localhost:' + port + '/reviews/';\n    }\n\n    /**\r\n     * Fetch all restaurants.\r\n     */\n\n  }, {\n    key: 'fetchRestaurants',\n    value: function fetchRestaurants(callback) {\n\n      DBHelper.getRestaurantsFromCache().then(function (restaurants) {\n\n        if (restaurants.length > 0) {\n          callback(null, restaurants);\n          return;\n        }\n        fetch(DBHelper.RESTAURANT_DATABASE_URL()).then(function (response) {\n          return response.json();\n        }).then(function (json) {\n          var restaurants = json;\n          DBHelper.addRestaurantsToCache(restaurants);\n\n          callback(null, restaurants);\n        }).catch(function (ex) {\n          var error = 'Request From Database failed.';\n          callback(error, null);\n        });\n      }).catch(function (ex) {\n        var error = 'Checking Cache failed';\n        callback(error, null);\n      });\n    }\n\n    /**\r\n     * Fetch a restaurant by its ID.\r\n     */\n\n  }, {\n    key: 'fetchRestaurantById',\n    value: function fetchRestaurantById(id, callback) {\n      // fetch all restaurants with proper error handling.\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          var restaurant = restaurants.find(function (r) {\n            return r.id == id;\n          });\n          if (restaurant) {\n            // Got the restaurant\n            callback(null, restaurant);\n          } else {\n            // Restaurant does not exist in the database\n            callback('Restaurant does not exist', null);\n          }\n        }\n      });\n    }\n\n    /**\r\n     * Fetch a review by restaurant ID.\r\n     */\n\n  }, {\n    key: 'fetchReviewById',\n    value: function fetchReviewById(id, callback) {\n      fetch(DBHelper.REVIEWS_DATABASE_URL(id)).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        var reviews = json;\n        DBHelper.addReviewsToCache(reviews);\n        callback(null, reviews);\n      }).catch(function (ex) {\n        var error = 'Reviews Request failed. Cache mode';\n        callback(error, null);\n        Promise.all([DBHelper.getReviewsFromCache(id), DBHelper.getReviewsFromOfflineCache(id)]).then(function (reviews) {\n          var _ref;\n\n          callback(null, (_ref = []).concat.apply(_ref, _toConsumableArray(reviews)));\n        }).catch(function (ex) {\n          var error = 'getting cache reviews  failed';\n          callback(error, null);\n        });\n      });\n    }\n\n    /**\r\n     * Fetch restaurants by a cuisine type with proper error handling.\r\n     */\n\n  }, {\n    key: 'fetchRestaurantByCuisine',\n    value: function fetchRestaurantByCuisine(cuisine, callback) {\n      // Fetch all restaurants  with proper error handling\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Filter restaurants to have only given cuisine type\n          var results = restaurants.filter(function (r) {\n            return r.cuisine_type == cuisine;\n          });\n          callback(null, results);\n        }\n      });\n    }\n\n    /**\r\n     * Fetch restaurants by a neighborhood with proper error handling.\r\n     */\n\n  }, {\n    key: 'fetchRestaurantByNeighborhood',\n    value: function fetchRestaurantByNeighborhood(neighborhood, callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Filter restaurants to have only given neighborhood\n          var results = restaurants.filter(function (r) {\n            return r.neighborhood == neighborhood;\n          });\n          callback(null, results);\n        }\n      });\n    }\n\n    /**\r\n     * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n     */\n\n  }, {\n    key: 'fetchRestaurantByCuisineAndNeighborhood',\n    value: function fetchRestaurantByCuisineAndNeighborhood(cuisine, neighborhood, callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n\n        if (error) {\n          callback(error, null);\n        } else {\n          var results = restaurants;\n          if (cuisine != 'all') {\n            // filter by cuisine\n            results = results.filter(function (r) {\n              return r.cuisine_type == cuisine;\n            });\n          }\n          if (neighborhood != 'all') {\n            // filter by neighborhood\n            results = results.filter(function (r) {\n              return r.neighborhood == neighborhood;\n            });\n          }\n          callback(null, results);\n        }\n      });\n    }\n\n    /**\r\n     * Fetch all neighborhoods with proper error handling.\r\n     */\n\n  }, {\n    key: 'fetchNeighborhoods',\n    value: function fetchNeighborhoods(callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Get all neighborhoods from all restaurants\n          var neighborhoods = restaurants.map(function (v, i) {\n            return restaurants[i].neighborhood;\n          });\n          // Remove duplicates from neighborhoods\n          var uniqueNeighborhoods = neighborhoods.filter(function (v, i) {\n            return neighborhoods.indexOf(v) == i;\n          });\n          callback(null, uniqueNeighborhoods);\n        }\n      });\n    }\n\n    /**\r\n     * Fetch all cuisines with proper error handling.\r\n     */\n\n  }, {\n    key: 'fetchCuisines',\n    value: function fetchCuisines(callback) {\n      // Fetch all restaurants\n      DBHelper.fetchRestaurants(function (error, restaurants) {\n        if (error) {\n          callback(error, null);\n        } else {\n          // Get all cuisines from all restaurants\n          var cuisines = restaurants.map(function (v, i) {\n            return restaurants[i].cuisine_type;\n          });\n          // Remove duplicates from cuisines\n          var uniqueCuisines = cuisines.filter(function (v, i) {\n            return cuisines.indexOf(v) == i;\n          });\n          callback(null, uniqueCuisines);\n        }\n      });\n    }\n\n    /**\r\n     * Restaurant page URL.\r\n     */\n\n  }, {\n    key: 'urlForRestaurant',\n    value: function urlForRestaurant(restaurant) {\n      return './restaurant.html?id=' + restaurant.id;\n    }\n\n    /**\r\n     * Restaurant image URL.\r\n     */\n\n  }, {\n    key: 'imageUrlForRestaurant',\n    value: function imageUrlForRestaurant(restaurant) {\n\n      return restaurant.id;\n    }\n\n    /**\r\n     * Map marker for a restaurant.\r\n     */\n\n  }, {\n    key: 'mapMarkerForRestaurant',\n    value: function mapMarkerForRestaurant(restaurant, map) {\n      var marker = new google.maps.Marker({\n        position: restaurant.latlng,\n        title: restaurant.name,\n        url: DBHelper.urlForRestaurant(restaurant),\n        map: map,\n        animation: google.maps.Animation.DROP });\n      return marker;\n    }\n  }]);\n\n  return DBHelper;\n}();\n\nexports.default = DBHelper;\n\n},{\"idb\":3}],2:[function(require,module,exports){\n'use strict';\n\nvar _dbhelper = require('./dbhelper');\n\nvar _dbhelper2 = _interopRequireDefault(_dbhelper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar restaurant = void 0;\nvar reviews = void 0;\nvar offlineReview = void 0;\nvar map;\n\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.register('./sw.js').then(function () {\n    console.log('Registration worked!');\n  }).catch(function () {\n    console.log('Registration failed!');\n  });\n  navigator.serviceWorker.ready.then(function (registration) {\n    var form = document.getElementById('review_form');\n    form.addEventListener('submit', function (e) {\n      e.preventDefault();\n      var reviews = submitReview();\n      if (reviews) {\n        _dbhelper2.default.saveReview(reviews).catch(function (ex) {\n          _dbhelper2.default.addReviewsToOfflineCache(reviews);\n          console.log('Failed to add review to database');\n          registration.sync.register('offline').then(function () {\n            console.log('Sync registered');\n          });\n        });\n      }\n    }, false);\n  });\n}\n/**\r\n * Initialize Google map, called from HTML.\r\n */\nwindow.initMap = function () {\n  fetchRestaurantFromURL(function (error, restaurant) {\n    if (error) {\n      // Got an error!\n      console.error(error);\n    } else {\n      addEventListeners();\n      var mapContainer = document.getElementById('map-container');\n      var url = 'https://maps.googleapis.com/maps/api/staticmap?center=' + restaurant.latlng.lat + ',' + restaurant.latlng.lng + '&zoom=16&size=600x500&key=AIzaSyDoChqwzBlFzWs0zw9QYGX-3DugvL-Zg-c';\n      mapContainer.style.backgroundImage = 'url(\"' + url + '\")';\n      self.map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 16,\n        center: restaurant.latlng,\n        scrollwheel: false\n      });\n      fillBreadcrumb();\n      _dbhelper2.default.mapMarkerForRestaurant(self.restaurant, self.map);\n    }\n  });\n  fetchReviewFromURL();\n};\n\nvar addEventListeners = function addEventListeners() {\n  var map_button = document.getElementById('map-button');\n  map_button.addEventListener('click', function () {\n    swap_map();\n  });\n};\n\nvar swap_map = function swap_map() {\n  document.getElementById('map-button').style.display = 'none';\n  document.getElementById('map').style.display = 'block';\n};\n/**\r\n * Get current restaurant from page URL.\r\n */\nvar fetchRestaurantFromURL = function fetchRestaurantFromURL(callback) {\n  if (self.restaurant) {\n    // restaurant already fetched!\n    callback(null, self.restaurant);\n    return;\n  }\n  var id = getParameterByName('id');\n  if (!id) {\n    // no id found in URL\n    error = 'No restaurant id in URL';\n    callback(error, null);\n  } else {\n    _dbhelper2.default.fetchRestaurantById(id, function (error, restaurant) {\n      self.restaurant = restaurant;\n      if (!restaurant) {\n        console.error(error);\n        return;\n      }\n      fillRestaurantHTML();\n      callback(null, restaurant);\n    });\n  }\n};\n\nvar fetchReviewFromURL = function fetchReviewFromURL() {\n\n  var id = getParameterByName('id');\n  if (!id) {\n    // no id found in URL\n    error = 'No restaurant id in URL';\n    console.error(error);\n  } else {\n    _dbhelper2.default.fetchReviewById(id, function (error, reviews) {\n      self.reviews = reviews;\n      if (!reviews) {\n        console.error(error);\n        return;\n      }\n      fillReviewsHTML();\n    });\n  }\n};\n\n/**\r\n * Create restaurant HTML and add it to the webpage\r\n */\nvar fillRestaurantHTML = function fillRestaurantHTML() {\n  var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;\n\n  var name = document.getElementById('restaurant-name');\n  name.innerHTML = restaurant.name;\n\n  var address = document.getElementById('restaurant-address');\n  address.innerHTML = restaurant.address;\n\n  var image = document.getElementById('restaurant-img');\n  image.className = 'restaurant-img';\n  image.alt = restaurant.name;\n  image.title = restaurant.name;\n\n  var filename = _dbhelper2.default.imageUrlForRestaurant(restaurant);\n\n  image.src = '/images/' + filename + '.jpg';\n  //depending on dpi since images are never above 400px\n  image.setAttribute('srcset', '/images/' + filename + '_800.jpg 2x, /images/' + filename + '.jpg 1x');\n\n  var cuisine = document.getElementById('restaurant-cuisine');\n  cuisine.innerHTML = restaurant.cuisine_type;\n\n  // fill operating hours\n  if (restaurant.operating_hours) {\n    fillRestaurantHoursHTML();\n  }\n  // fill reviews\n  //fillReviewsHTML();\n};\n\n/**\r\n * Create restaurant operating hours HTML table and add it to the webpage.\r\n */\nvar fillRestaurantHoursHTML = function fillRestaurantHoursHTML() {\n  var operatingHours = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant.operating_hours;\n\n  var hours = document.getElementById('restaurant-hours');\n  var rowTH = document.createElement('tr');\n  var dayTh = document.createElement('th');\n  var timeTH = document.createElement('th');\n\n  dayTh.innerHTML = \"Days\";\n  timeTH.innerHTML = \"Opening Hours\";\n\n  rowTH.appendChild(dayTh);\n  rowTH.appendChild(timeTH);\n  hours.appendChild(rowTH);\n\n  for (var key in operatingHours) {\n    var row = document.createElement('tr');\n\n    var day = document.createElement('td');\n    day.innerHTML = key;\n    row.appendChild(day);\n\n    var time = document.createElement('td');\n    time.innerHTML = operatingHours[key];\n    row.appendChild(time);\n\n    hours.appendChild(row);\n  }\n};\n\n/**\r\n * Create all reviews HTML and add them to the webpage.\r\n */\nvar fillReviewsHTML = function fillReviewsHTML() {\n  var reviews = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.reviews;\n\n  var container = document.getElementById('reviews_content');\n  var title = document.createElement('h3');\n  title.innerHTML = 'Reviews';\n  container.appendChild(title);\n\n  if (reviews.length == 0) {\n    var noReviews = document.createElement('p');\n    noReviews.innerHTML = 'No reviews yet!';\n    noReviews.setAttribute(\"id\", \"empty\");\n    container.appendChild(noReviews);\n    return;\n  }\n  var ul = document.getElementById('reviews-list');\n  reviews.forEach(function (review) {\n    ul.appendChild(createReviewHTML(review));\n  });\n  container.appendChild(ul);\n};\n\n/**\r\n * Create review HTML and add it to the webpage.\r\n */\nvar createReviewHTML = function createReviewHTML(review) {\n  var li = document.createElement('li');\n\n  var header = document.createElement('div');\n  header.className = \"header-review\";\n\n  var name = document.createElement('p');\n  name.innerHTML = review.name;\n  header.appendChild(name);\n\n  var date = document.createElement('p');\n  var dateOptions = { year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric' };\n  date.innerHTML = new Date(review.createdAt).toLocaleDateString(\"en-US\", dateOptions);\n  header.appendChild(date);\n\n  li.appendChild(header);\n\n  var rating = document.createElement('p');\n  rating.className = \"rating-review\";\n  rating.innerHTML = 'Rating: ' + review.rating;\n  li.appendChild(rating);\n\n  var comments = document.createElement('p');\n  comments.innerHTML = review.comments;\n  li.appendChild(comments);\n\n  return li;\n};\n\n/**\r\n * Add restaurant name to the breadcrumb navigation menu\r\n */\nvar fillBreadcrumb = function fillBreadcrumb() {\n  var restaurant = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : self.restaurant;\n\n  var breadcrumb = document.getElementById('breadcrumb');\n  var li = document.createElement('li');\n  li.innerHTML = restaurant.name;\n  breadcrumb.appendChild(li);\n};\n\n/**\r\n * Get a parameter by name from page URL.\r\n */\nvar getParameterByName = function getParameterByName(name, url) {\n  if (!url) url = window.location.href;\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\n  var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),\n      results = regex.exec(url);\n  if (!results) return null;\n  if (!results[2]) return '';\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\n};\n\nvar submitReview = function submitReview() {\n  var restaurant_id = getParameterByName('id');\n  if (!restaurant_id) {\n    error = 'No restaurant id in URL';\n    console.error(error);\n    return;\n  } else {\n    var _reviews = validation();\n    if (_reviews) {\n      _reviews['restaurant_id'] = parseInt(restaurant_id);\n      document.getElementById('review_form').reset();\n      addReviewToDom(_reviews);\n      return _reviews;\n    } else return false;\n  }\n};\n\nvar validation = function validation() {\n  var reviews = {};\n  reviews['name'] = document.getElementById('name').value;\n  reviews['rating'] = parseInt(document.getElementById('rate').value);\n  reviews['comments'] = document.getElementById('comment').value;\n  reviews['createdAt'] = new Date().getTime();\n  reviews['updatedAt'] = new Date().getTime();\n\n  if (reviews['name'] == \"\" || reviews['comments'] == \"\") {\n    document.getElementById('validation-error').style.display = \"block\";\n    return false;\n  } else return reviews;\n};\n\nvar addReviewToDom = function addReviewToDom(reviews) {\n  if (self.reviews.length == 0) {\n    var container = document.getElementById('reviews_content');\n    var ul = document.createElement('ul');\n    var li = createReviewHTML(reviews);\n    var p = document.getElementById('empty');\n\n    p.innerHTML = '';\n    ul.setAttribute(\"id\", \"reviews-list\");\n    ul.appendChild(li);\n    container.appendChild(ul);\n  } else {\n    var _ul = document.getElementById('reviews-list');\n    var _li = createReviewHTML(reviews);\n    _ul.appendChild(_li);\n  }\n};\n\n},{\"./dbhelper\":1}],3:[function(require,module,exports){\n'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n\n},{}]},{},[1,2]);\n"]}